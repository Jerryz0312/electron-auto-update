PS C:\projects\nsis-test\certs> $rootCert = New-SelfSignedCertificate -DnsName "martin" -Type CodeSigningCert -CertStore
Location "C:\projects\nsis-test\certs\"

PS C:\projects\nsis-test\certs> [System.Security.SecureString]$rootcertPassword = ConvertTo-SecureString -String "some_password" -Force -AsPlainText

PS C:\projects\nsis-test\certs> [String]$rootCertPath = Join-Path -Path 'cert:\CurrentUser\My\' -ChildPath "$($rootcert.Thumbprint)"

PS C:\projects\nsis-test\certs> [String]$rootCertPath = Join-Path -Path 'cert:\LocalMachine\My\' -ChildPath "$($rootcert.Thumbprint)"

PS C:\projects\nsis-test\certs> Export-PfxCertificate -Cert $rootCertPath -FilePath 'RootCA.pfx' -Password $rootcertPassword


    Directory: C:\projects\nsis-test\certs


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        8.5.2019.     18:18           2621 RootCA.pfx


PS C:\projects\nsis-test\certs> Export-Certificate -Cert $rootCertPath -FilePath 'RootCA.crt'
